#include <assert.h>
#include <string.h>

#include <secp256k1.h>
#include <secp256k1_schnorrsig.h>

#include "examples_util.h"

int main(void) {
    unsigned char seckey[32] = {
        0xcb, 0x6b, 0xb4, 0x55, 0x19, 0x55, 0xd8, 0xb5, 0xad, 0x3e, 0xbc, 0x3b, 0x3a, 0x76, 0x46, 0x01,
        0xed, 0x4e, 0x37, 0x3f, 0x54, 0xdd, 0x19, 0x5a, 0x87, 0x21, 0xe7, 0xbe, 0xc2, 0x4e, 0xe4, 0x2b
    };

    unsigned char message[32] = {
        0x89, 0xea, 0xb2, 0x65, 0xa7, 0xe5, 0x20, 0xb0, 0x70, 0xee, 0x2e, 0x9a, 0x56, 0xb1, 0xae, 0x53,
        0x2f, 0xac, 0x0b, 0xd9, 0x11, 0xd0, 0x90, 0x86, 0x79, 0x43, 0xb6, 0x4f, 0x32, 0xb6, 0x39, 0x6e
    };

    secp256k1_context* ctx;
    secp256k1_keypair keypair;

    unsigned char auxiliary_rand[32];
    unsigned char signature[64];

    ctx = secp256k1_context_create(SECP256K1_CONTEXT_NONE);
    assert(secp256k1_keypair_create(ctx, &keypair, seckey));
    assert(fill_random(auxiliary_rand, sizeof(auxiliary_rand)));

    assert(secp256k1_schnorrsig_sign32(ctx, signature, message, &keypair, auxiliary_rand));

    print_hex(signature, sizeof(signature));

    return 0;
}
